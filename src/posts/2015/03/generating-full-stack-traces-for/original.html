<!DOCTYPE html>
<html class='v2' dir='ltr' lang='en'>
<head>
<link href='https://www.blogger.com/static/v1/widgets/2508126174-css_bundle_v2.css' rel='stylesheet' type='text/css'/>
<meta content='width=1100' name='viewport'/>
<meta content='text/html; charset=UTF-8' http-equiv='Content-Type'/>
<meta content='blogger' name='generator'/>
<link href='http://blog.dscpl.com.au/favicon.ico' rel='icon' type='image/x-icon'/>
<link href='http://blog.dscpl.com.au/2015/03/generating-full-stack-traces-for.html' rel='canonical'/>
<link rel="alternate" type="application/atom+xml" title="Graham Dumpleton - Atom" href="http://blog.dscpl.com.au/feeds/posts/default" />
<link rel="alternate" type="application/rss+xml" title="Graham Dumpleton - RSS" href="http://blog.dscpl.com.au/feeds/posts/default?alt=rss" />
<link rel="service.post" type="application/atom+xml" title="Graham Dumpleton - Atom" href="https://www.blogger.com/feeds/2363643920942057324/posts/default" />

<link rel="alternate" type="application/atom+xml" title="Graham Dumpleton - Atom" href="http://blog.dscpl.com.au/feeds/7672746776551574219/comments/default" />
<!--Can't find substitution for tag [blog.ieCssRetrofitLinks]-->
<meta content='http://blog.dscpl.com.au/2015/03/generating-full-stack-traces-for.html' property='og:url'/>
<meta content='Generating full stack traces for exceptions in Python.' property='og:title'/>
<meta content='My last few blog posts have been about monkey patching. I will be continuing with more posts on that topic, but I am going to take a slight ...' property='og:description'/>
<title>Graham Dumpleton: Generating full stack traces for exceptions in Python.</title>
<style id='page-skin-1' type='text/css'><!--
/*
-----------------------------------------------
Blogger Template Style
Name:     Simple
Designer: Blogger
URL:      www.blogger.com
----------------------------------------------- */
/* Content
----------------------------------------------- */
body {
font: normal normal 12px Arial, Tahoma, Helvetica, FreeSans, sans-serif;
color: #222222;
background: #66bbdd none repeat scroll top left;
padding: 0 40px 40px 40px;
}
html body .region-inner {
min-width: 0;
max-width: 100%;
width: auto;
}
h2 {
font-size: 22px;
}
a:link {
text-decoration:none;
color: #2187bb;
}
a:visited {
text-decoration:none;
color: #888888;
}
a:hover {
text-decoration:underline;
color: #32aaff;
}
.body-fauxcolumn-outer .fauxcolumn-inner {
background: transparent none repeat scroll top left;
_background-image: none;
}
.body-fauxcolumn-outer .cap-top {
position: absolute;
z-index: 1;
height: 400px;
width: 100%;
}
.body-fauxcolumn-outer .cap-top .cap-left {
width: 100%;
background: transparent none repeat-x scroll top left;
_background-image: none;
}
.content-outer {
-moz-box-shadow: 0 0 40px rgba(0, 0, 0, .15);
-webkit-box-shadow: 0 0 5px rgba(0, 0, 0, .15);
-goog-ms-box-shadow: 0 0 10px #333333;
box-shadow: 0 0 40px rgba(0, 0, 0, .15);
margin-bottom: 1px;
}
.content-inner {
padding: 10px 10px;
}
.content-inner {
background-color: #ffffff;
}
/* Header
----------------------------------------------- */
.header-outer {
background: transparent none repeat-x scroll 0 -400px;
_background-image: none;
}
.Header h1 {
font: normal normal 60px Arial, Tahoma, Helvetica, FreeSans, sans-serif;
color: #3299bb;
text-shadow: -1px -1px 1px rgba(0, 0, 0, .2);
}
.Header h1 a {
color: #3299bb;
}
.Header .description {
font-size: 140%;
color: #777777;
}
.header-inner .Header .titlewrapper {
padding: 22px 30px;
}
.header-inner .Header .descriptionwrapper {
padding: 0 30px;
}
/* Tabs
----------------------------------------------- */
.tabs-inner .section:first-child {
border-top: 1px solid #eeeeee;
}
.tabs-inner .section:first-child ul {
margin-top: -1px;
border-top: 1px solid #eeeeee;
border-left: 0 solid #eeeeee;
border-right: 0 solid #eeeeee;
}
.tabs-inner .widget ul {
background: #f5f5f5 url(https://resources.blogblog.com/blogblog/data/1kt/simple/gradients_light.png) repeat-x scroll 0 -800px;
_background-image: none;
border-bottom: 1px solid #eeeeee;
margin-top: 0;
margin-left: -30px;
margin-right: -30px;
}
.tabs-inner .widget li a {
display: inline-block;
padding: .6em 1em;
font: normal normal 14px Arial, Tahoma, Helvetica, FreeSans, sans-serif;
color: #999999;
border-left: 1px solid #ffffff;
border-right: 1px solid #eeeeee;
}
.tabs-inner .widget li:first-child a {
border-left: none;
}
.tabs-inner .widget li.selected a, .tabs-inner .widget li a:hover {
color: #000000;
background-color: #eeeeee;
text-decoration: none;
}
/* Columns
----------------------------------------------- */
.main-outer {
border-top: 0 solid #eeeeee;
}
.fauxcolumn-left-outer .fauxcolumn-inner {
border-right: 1px solid #eeeeee;
}
.fauxcolumn-right-outer .fauxcolumn-inner {
border-left: 1px solid #eeeeee;
}
/* Headings
----------------------------------------------- */
div.widget > h2,
div.widget h2.title {
margin: 0 0 1em 0;
font: normal bold 11px Arial, Tahoma, Helvetica, FreeSans, sans-serif;
color: #000000;
}
/* Widgets
----------------------------------------------- */
.widget .zippy {
color: #999999;
text-shadow: 2px 2px 1px rgba(0, 0, 0, .1);
}
.widget .popular-posts ul {
list-style: none;
}
/* Posts
----------------------------------------------- */
h2.date-header {
font: normal bold 11px Arial, Tahoma, Helvetica, FreeSans, sans-serif;
}
.date-header span {
background-color: transparent;
color: #222222;
padding: inherit;
letter-spacing: inherit;
margin: inherit;
}
.main-inner {
padding-top: 30px;
padding-bottom: 30px;
}
.main-inner .column-center-inner {
padding: 0 15px;
}
.main-inner .column-center-inner .section {
margin: 0 15px;
}
.post {
margin: 0 0 25px 0;
}
h3.post-title, .comments h4 {
font: normal normal 22px Arial, Tahoma, Helvetica, FreeSans, sans-serif;
margin: .75em 0 0;
}
.post-body {
font-size: 110%;
line-height: 1.4;
position: relative;
}
.post-body img, .post-body .tr-caption-container, .Profile img, .Image img,
.BlogList .item-thumbnail img {
padding: 2px;
background: #ffffff;
border: 1px solid #eeeeee;
-moz-box-shadow: 1px 1px 5px rgba(0, 0, 0, .1);
-webkit-box-shadow: 1px 1px 5px rgba(0, 0, 0, .1);
box-shadow: 1px 1px 5px rgba(0, 0, 0, .1);
}
.post-body img, .post-body .tr-caption-container {
padding: 5px;
}
.post-body .tr-caption-container {
color: #222222;
}
.post-body .tr-caption-container img {
padding: 0;
background: transparent;
border: none;
-moz-box-shadow: 0 0 0 rgba(0, 0, 0, .1);
-webkit-box-shadow: 0 0 0 rgba(0, 0, 0, .1);
box-shadow: 0 0 0 rgba(0, 0, 0, .1);
}
.post-header {
margin: 0 0 1.5em;
line-height: 1.6;
font-size: 90%;
}
.post-footer {
margin: 20px -2px 0;
padding: 5px 10px;
color: #666666;
background-color: #f9f9f9;
border-bottom: 1px solid #eeeeee;
line-height: 1.6;
font-size: 90%;
}
#comments .comment-author {
padding-top: 1.5em;
border-top: 1px solid #eeeeee;
background-position: 0 1.5em;
}
#comments .comment-author:first-child {
padding-top: 0;
border-top: none;
}
.avatar-image-container {
margin: .2em 0 0;
}
#comments .avatar-image-container img {
border: 1px solid #eeeeee;
}
/* Comments
----------------------------------------------- */
.comments .comments-content .icon.blog-author {
background-repeat: no-repeat;
background-image: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABIAAAASCAYAAABWzo5XAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEgAACxIB0t1+/AAAAAd0SU1FB9sLFwMeCjjhcOMAAAD+SURBVDjLtZSvTgNBEIe/WRRnm3U8RC1neQdsm1zSBIU9VVF1FkUguQQsD9ITmD7ECZIJSE4OZo9stoVjC/zc7ky+zH9hXwVwDpTAWWLrgS3QAe8AZgaAJI5zYAmc8r0G4AHYHQKVwII8PZrZFsBFkeRCABYiMh9BRUhnSkPTNCtVXYXURi1FpBDgArj8QU1eVXUzfnjv7yP7kwu1mYrkWlU33vs1QNu2qU8pwN0UpKoqokjWwCztrMuBhEhmh8bD5UDqur75asbcX0BGUB9/HAMB+r32hznJgXy2v0sGLBcyAJ1EK3LFcbo1s91JeLwAbwGYu7TP/3ZGfnXYPgAVNngtqatUNgAAAABJRU5ErkJggg==);
}
.comments .comments-content .loadmore a {
border-top: 1px solid #999999;
border-bottom: 1px solid #999999;
}
.comments .comment-thread.inline-thread {
background-color: #f9f9f9;
}
.comments .continue {
border-top: 2px solid #999999;
}
/* Accents
---------------------------------------------- */
.section-columns td.columns-cell {
border-left: 1px solid #eeeeee;
}
.blog-pager {
background: transparent none no-repeat scroll top center;
}
.blog-pager-older-link, .home-link,
.blog-pager-newer-link {
background-color: #ffffff;
padding: 5px;
}
.footer-outer {
border-top: 0 dashed #bbbbbb;
}
/* Mobile
----------------------------------------------- */
body.mobile  {
background-size: auto;
}
.mobile .body-fauxcolumn-outer {
background: transparent none repeat scroll top left;
}
.mobile .body-fauxcolumn-outer .cap-top {
background-size: 100% auto;
}
.mobile .content-outer {
-webkit-box-shadow: 0 0 3px rgba(0, 0, 0, .15);
box-shadow: 0 0 3px rgba(0, 0, 0, .15);
}
.mobile .tabs-inner .widget ul {
margin-left: 0;
margin-right: 0;
}
.mobile .post {
margin: 0;
}
.mobile .main-inner .column-center-inner .section {
margin: 0;
}
.mobile .date-header span {
padding: 0.1em 10px;
margin: 0 -10px;
}
.mobile h3.post-title {
margin: 0;
}
.mobile .blog-pager {
background: transparent none no-repeat scroll top center;
}
.mobile .footer-outer {
border-top: none;
}
.mobile .main-inner, .mobile .footer-inner {
background-color: #ffffff;
}
.mobile-index-contents {
color: #222222;
}
.mobile-link-button {
background-color: #2187bb;
}
.mobile-link-button a:link, .mobile-link-button a:visited {
color: #ffffff;
}
.mobile .tabs-inner .section:first-child {
border-top: none;
}
.mobile .tabs-inner .PageList .widget-content {
background-color: #eeeeee;
color: #000000;
border-top: 1px solid #eeeeee;
border-bottom: 1px solid #eeeeee;
}
.mobile .tabs-inner .PageList .widget-content .pagelist-arrow {
border-left: 1px solid #eeeeee;
}

--></style>
<style id='template-skin-1' type='text/css'><!--
body {
min-width: 1020px;
}
.content-outer, .content-fauxcolumn-outer, .region-inner {
min-width: 1020px;
max-width: 1020px;
_width: 1020px;
}
.main-inner .columns {
padding-left: 0px;
padding-right: 200px;
}
.main-inner .fauxcolumn-center-outer {
left: 0px;
right: 200px;
/* IE6 does not respect left and right together */
_width: expression(this.parentNode.offsetWidth -
parseInt("0px") -
parseInt("200px") + 'px');
}
.main-inner .fauxcolumn-left-outer {
width: 0px;
}
.main-inner .fauxcolumn-right-outer {
width: 200px;
}
.main-inner .column-left-outer {
width: 0px;
right: 100%;
margin-left: -0px;
}
.main-inner .column-right-outer {
width: 200px;
margin-right: -200px;
}
#layout {
min-width: 0;
}
#layout .content-outer {
min-width: 0;
width: 800px;
}
#layout .region-inner {
min-width: 0;
width: auto;
}
body#layout div.add_widget {
padding: 8px;
}
body#layout div.add_widget a {
margin-left: 32px;
}
--></style>
<link href='https://www.blogger.com/dyn-css/authorization.css?targetBlogID=2363643920942057324&amp;zx=8e425bf4-e933-49a5-a874-6a5d9cccad39' media='none' onload='if(media!=&#39;all&#39;)media=&#39;all&#39;' rel='stylesheet'/><noscript><link href='https://www.blogger.com/dyn-css/authorization.css?targetBlogID=2363643920942057324&amp;zx=8e425bf4-e933-49a5-a874-6a5d9cccad39' rel='stylesheet'/></noscript>
<meta name='google-adsense-platform-account' content='ca-host-pub-1556223355139109'/>
<meta name='google-adsense-platform-domain' content='blogspot.com'/>

<!-- data-ad-client=ca-pub-6433235630058377 -->

</head>
<body class='loading variant-pale'>
<div class='navbar section' id='navbar' name='Navbar'><div class='widget Navbar' data-version='1' id='Navbar1'><script type="text/javascript">
    function setAttributeOnload(object, attribute, val) {
      if(window.addEventListener) {
        window.addEventListener('load',
          function(){ object[attribute] = val; }, false);
      } else {
        window.attachEvent('onload', function(){ object[attribute] = val; });
      }
    }
  </script>
<div id="navbar-iframe-container"></div>
<script type="text/javascript" src="https://apis.google.com/js/platform.js"></script>
<script type="text/javascript">
      gapi.load("gapi.iframes:gapi.iframes.style.bubble", function() {
        if (gapi.iframes && gapi.iframes.getContext) {
          gapi.iframes.getContext().openChild({
              url: 'https://www.blogger.com/navbar/2363643920942057324?po\x3d7672746776551574219\x26origin\x3dhttp://blog.dscpl.com.au',
              where: document.getElementById("navbar-iframe-container"),
              id: "navbar-iframe"
          });
        }
      });
    </script><script type="text/javascript">
(function() {
var script = document.createElement('script');
script.type = 'text/javascript';
script.src = '//pagead2.googlesyndication.com/pagead/js/google_top_exp.js';
var head = document.getElementsByTagName('head')[0];
if (head) {
head.appendChild(script);
}})();
</script>
</div></div>
<div class='body-fauxcolumns'>
<div class='fauxcolumn-outer body-fauxcolumn-outer'>
<div class='cap-top'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
<div class='fauxborder-left'>
<div class='fauxborder-right'></div>
<div class='fauxcolumn-inner'>
</div>
</div>
<div class='cap-bottom'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
</div>
</div>
<div class='content'>
<div class='content-fauxcolumns'>
<div class='fauxcolumn-outer content-fauxcolumn-outer'>
<div class='cap-top'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
<div class='fauxborder-left'>
<div class='fauxborder-right'></div>
<div class='fauxcolumn-inner'>
</div>
</div>
<div class='cap-bottom'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
</div>
</div>
<div class='content-outer'>
<div class='content-cap-top cap-top'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
<div class='fauxborder-left content-fauxborder-left'>
<div class='fauxborder-right content-fauxborder-right'></div>
<div class='content-inner'>
<header>
<div class='header-outer'>
<div class='header-cap-top cap-top'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
<div class='fauxborder-left header-fauxborder-left'>
<div class='fauxborder-right header-fauxborder-right'></div>
<div class='region-inner header-inner'>
<div class='header section' id='header' name='Header'><div class='widget Header' data-version='1' id='Header1'>
<div id='header-inner'>
<div class='titlewrapper'>
<h1 class='title'>
<a href='http://blog.dscpl.com.au/'>
Graham Dumpleton
</a>
</h1>
</div>
<div class='descriptionwrapper'>
<p class='description'><span>
</span></p>
</div>
</div>
</div></div>
</div>
</div>
<div class='header-cap-bottom cap-bottom'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
</div>
</header>
<div class='tabs-outer'>
<div class='tabs-cap-top cap-top'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
<div class='fauxborder-left tabs-fauxborder-left'>
<div class='fauxborder-right tabs-fauxborder-right'></div>
<div class='region-inner tabs-inner'>
<div class='tabs no-items section' id='crosscol' name='Cross-Column'></div>
<div class='tabs no-items section' id='crosscol-overflow' name='Cross-Column 2'></div>
</div>
</div>
<div class='tabs-cap-bottom cap-bottom'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
</div>
<div class='main-outer'>
<div class='main-cap-top cap-top'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
<div class='fauxborder-left main-fauxborder-left'>
<div class='fauxborder-right main-fauxborder-right'></div>
<div class='region-inner main-inner'>
<div class='columns fauxcolumns'>
<div class='fauxcolumn-outer fauxcolumn-center-outer'>
<div class='cap-top'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
<div class='fauxborder-left'>
<div class='fauxborder-right'></div>
<div class='fauxcolumn-inner'>
</div>
</div>
<div class='cap-bottom'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
</div>
<div class='fauxcolumn-outer fauxcolumn-left-outer'>
<div class='cap-top'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
<div class='fauxborder-left'>
<div class='fauxborder-right'></div>
<div class='fauxcolumn-inner'>
</div>
</div>
<div class='cap-bottom'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
</div>
<div class='fauxcolumn-outer fauxcolumn-right-outer'>
<div class='cap-top'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
<div class='fauxborder-left'>
<div class='fauxborder-right'></div>
<div class='fauxcolumn-inner'>
</div>
</div>
<div class='cap-bottom'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
</div>
<!-- corrects IE6 width calculation -->
<div class='columns-inner'>
<div class='column-center-outer'>
<div class='column-center-inner'>
<div class='main section' id='main' name='Main'><div class='widget Blog' data-version='1' id='Blog1'>
<div class='blog-posts hfeed'>

          <div class="date-outer">
        
<h2 class='date-header'><span>Saturday, March 21, 2015</span></h2>

          <div class="date-posts">
        
<div class='post-outer'>
<div class='post hentry uncustomized-post-template' itemprop='blogPost' itemscope='itemscope' itemtype='http://schema.org/BlogPosting'>
<meta content='2363643920942057324' itemprop='blogId'/>
<meta content='7672746776551574219' itemprop='postId'/>
<a name='7672746776551574219'></a>
<h3 class='post-title entry-title' itemprop='name'>
Generating full stack traces for exceptions in Python.
</h3>
<div class='post-header'>
<div class='post-header-line-1'></div>
</div>
<div class='post-body entry-content' id='post-body-7672746776551574219' itemprop='description articleBody'>
<p>My last few blog posts have been about monkey patching. I will be continuing with more posts on that topic, but I am going to take a slight detour away from that topic in this post to talk about a problem related to capturing stack trace information for exceptions in Python applications.</p>
<p>This does still have some relevance to monkey patching, in as much as one of the reasons you may want to monkey patch a Python application is to add in wrappers which will intercept the the details of an exception raised deep with an application. You might want to do this for the case where the exception would otherwise be captured by an application and translated into a different exception, with loss of information about the inner exception, or in the case of a web application result in a generic HTTP 500 web page response with no useful information captured. So monkey patching can be a useful debugging tool where it may not be convenient to modify the original source code of the application.</p>
<h1>Tracebacks for exceptions</h1>
<p>To get started, lets consider the following Python script:</p>
<blockquote>
<pre>def function1():<br />&#160; &#160; raise RuntimeError('xxx')</pre>
<pre>def function2():<br />&#160; &#160; function1()</pre>
<pre>def function3():<br />&#160; &#160; function2()</pre>
<pre>def function4():<br />&#160; &#160; function3()</pre>
<pre>def function5():<br />&#160; &#160; function4()</pre>
<pre>function5()</pre>
</blockquote>
<p>If we run this script we will get:</p>
<blockquote>
<pre>Traceback (most recent call last):<br />&#160; File "generate-1.py", line 16, in &lt;module&gt;<br />&#160; &#160; function5()<br />&#160; File "generate-1.py", line 14, in function5<br />&#160; &#160; function4()<br />&#160; File "generate-1.py", line 11, in function4<br />&#160; &#160; function3()<br />&#160; File "generate-1.py", line 8, in function3<br />&#160; &#160; function2()<br />&#160; File "generate-1.py", line 5, in function2<br />&#160; &#160; function1()<br />&#160; File "generate-1.py", line 2, in function1<br />&#160; &#160; raise RuntimeError('xxx')<br />RuntimeError: xxx</pre>
</blockquote>
<p>In this case we have an exception occurring which was never actually caught within the script itself and is propagated all the way up to the top level, causing the script to be terminated and the traceback printed.</p>
<p>When the traceback was printed, it showed all stack frames from the top level all the way down to the point where the exception occurred.</p>
<p>Now consider the Python script:</p>
<blockquote>
<pre>import traceback</pre>
<pre>def function1():<br />&#160; &#160; raise RuntimeError('xxx')</pre>
<pre>def function2():<br />&#160; &#160; function1()</pre>
<pre>def function3():<br />&#160; &#160; try:<br />&#160; &#160; &#160; function2()<br />&#160; &#160; except Exception:<br />&#160; &#160; &#160; traceback.print_exc()</pre>
<pre>def function4():<br />&#160; &#160; function3()</pre>
<pre>def function5():<br />&#160; &#160; function4()</pre>
<pre>function5()</pre>
</blockquote>
<p>In this script we have a 'try/except' block half way down the sequence of calls. The call to 'function2()' is made within the 'try' block and when the exception is raised, it is handled within the 'except' block. At that point we use the 'traceback.print_exc()' function to output the details of the exception, but then let the script continue on normally to completion.</p>
<p>For this Python script the output is:</p>
<blockquote>
<pre>Traceback (most recent call last):<br />&#160; File "generate-2.py", line 11, in function3<br />&#160; &#160; function2()<br />&#160; File "generate-2.py", line 7, in function2<br />&#160; &#160; function1()<br />&#160; File "generate-2.py", line 4, in function1<br />&#160; &#160; raise RuntimeError('xxx')<br />RuntimeError: xxx</pre>
</blockquote>
<p>What you see here though is that we loose information about the outer stack frames for the sequence of calls that led down to the point where the 'try/except' block existed.</p>
<p>When we want to capture details of an exception for logging purposes so as to later debug an issue, this loss of information can make it harder to debug a problem if the function containing the 'try/except' block could be called from multiple places.</p>
<p>How then can we capture the outer stack frames so we have that additional context?</p>
<h1>Capturing the current stack</h1>
<p>There are a number of ways of obtaining information about the current stack. If we are just wanting to dump out the current stack to a log then we can use 'traceback.print_stack()'.</p>
<blockquote>
<pre>import traceback</pre>
<pre>def function1():<br />&#160; &#160; raise RuntimeError('xxx')</pre>
<pre>def function2():<br />&#160; &#160; function1()</pre>
<pre>def function3():<br />&#160; &#160; try:<br />&#160; &#160; &#160; &#160; function2()<br />&#160; &#160; except Exception:<br />&#160; &#160; &#160; &#160; traceback.print_stack()<br />&#160; &#160; &#160; &#160; print '--------------'<br />&#160; &#160; &#160; &#160; traceback.print_exc()</pre>
<pre>def function4():<br />&#160; &#160; function3()</pre>
<pre>def function5():<br />&#160; &#160; function4()</pre>
<pre>function5()</pre>
</blockquote>
<p>Run this variant of the Python script and we now get:</p>
<blockquote>
<pre>&#160; File "generate-3.py", line 23, in &lt;module&gt;<br />&#160; &#160; function5()<br />&#160; File "generate-3.py", line 21, in function5<br />&#160; &#160; function4()<br />&#160; File "generate-3.py", line 18, in function4<br />&#160; &#160; function3()<br />&#160; File "generate-3.py", line 13, in function3<br />&#160; &#160; traceback.print_stack()<br />--------------<br />Traceback (most recent call last):<br />&#160; File "generate-3.py", line 11, in function3<br />&#160; &#160; function2()<br />&#160; File "generate-3.py", line 7, in function2<br />&#160; &#160; function1()<br />&#160; File "generate-3.py", line 4, in function1<br />&#160; &#160; raise RuntimeError('xxx')<br />RuntimeError: xxx</pre>
</blockquote>
<p>So we now have the inner stack frames corresponding to the exception traceback, as well as those outer stack frames corresponding to the current stack. From this we can presumably now join these two sets of stack frames together and get a complete stack trace for where the exception occurred.</p>
<p>If you look closely though you may notice something. That is that there is actually an overlap in the stack frames which are shown for each, plus that the function we have called to print the current stack is also shown.</p>
<p>In the case of the overlap the issue is that in the inner stack frames from the traceback, it shows an execution point in 'function3()' of line 11. This corresponds to the point where 'function2()' was called within the 'try' block and in which the exception occurred.</p>
<p>At the same time, the outer stack frames from the current execution stack show line 13 in 'function3()', which is the point within the 'except' block where we called 'traceback.print_stack()' to display the current stack.</p>
<p>So the top most stack frame from the traceback is actually want we want and we need to ignore the bottom most two stack frames from the current stack if we were to join these together.</p>
<p>Now although the output of these two functions can be directed to any file like object and thus an instance of 'StringIO' could be used to capture the output, we would still need to break apart the formatted text output, drop certain parts and rearrange others to get the final desired result.</p>
<p>Dealing with such pre formatted output could therefore be a pain, especially if what we really wanted was the raw information about the filename, line number, function and potentially the code snippet. What other options therefore exist for getting such raw information?</p>
<h1>Using the inspect module</h1>
<p>When needing to perform introspection or otherwise derive information about Python objects, the module you want to use is the 'inspect' module. For the case of getting information about the current exception and current stack, the two functions you can use are 'inspect.trace()' and 'inspect.stack()'. Using these we can rewrite our Python script as:</p>
<blockquote>
<pre>import inspect</pre>
<pre>def function1():<br />&#160; &#160; raise RuntimeError('xxx')</pre>
<pre>def function2():<br />&#160; &#160; function1()</pre>
<pre>def function3():<br />&#160; &#160; try:<br />&#160; &#160; &#160; &#160; function2()<br />&#160; &#160; except Exception:<br />&#160; &#160; &#160; &#160; for item in reversed(inspect.stack()):<br />&#160; &#160; &#160; &#160; &#160; &#160; print item[1:]<br />&#160; &#160; &#160; &#160; print '--------------'<br />&#160; &#160; &#160; &#160; for item in inspect.trace():<br />&#160; &#160; &#160; &#160; &#160; &#160; print item[1:]</pre>
<pre>def function4():<br />&#160; &#160; function3()</pre>
<pre>def function5():<br />&#160; &#160; function4()</pre>
<pre>function5()</pre>
</blockquote>
<p>This time we get:</p>
<pre>('generate-4.py', 25, '&lt;module&gt;', ['function5()\n'], 0)<br />('generate-4.py', 23, 'function5', [' function4()\n'], 0)<br />('generate-4.py', 20, 'function4', [' function3()\n'], 0)<br />('generate-4.py', 13, 'function3', [' for item in reversed(inspect.stack()):\n'], 0)<br />--------------<br />('generate-4.py', 11, 'function3', [' function2()\n'], 0)<br />('generate-4.py', 7, 'function2', [' function1()\n'], 0)<br />('generate-4.py', 4, 'function1', [" raise RuntimeError('xxx')\n"], 0)</pre>
<p>So these functions provide us with the raw information rather than pre formatted text, thus making it easier to process. For each stack frame we also get a reference to the frame object itself, but since we didn't care about that we skipped it when displaying each frame.</p>
<p>Because though we might want to generate such a combined stack trace in multiple places we obviously separate this out into a function of its own.</p>
<blockquote>
<pre>import inspect</pre>
<pre>def print_full_stack():<br />&#160; &#160; print 'Traceback (most recent call last):'<br />&#160; &#160; for item in reversed(inspect.stack()[2:]):<br />&#160; &#160; &#160; &#160; print ' File "{1}", line {2}, in {3}\n'.format(*item),<br />&#160; &#160; for line in item[4]:<br />&#160; &#160; &#160; &#160; print ' ' + line.lstrip(),<br />&#160; &#160; for item in inspect.trace():<br />&#160; &#160; &#160; &#160; print ' File "{1}", line {2}, in {3}\n'.format(*item),<br />&#160; &#160; for line in item[4]:<br />&#160; &#160; &#160; &#160; print ' ' + line.lstrip(),</pre>
<pre>def function1():<br />&#160; &#160; raise RuntimeError('xxx')</pre>
<pre>def function2():<br />&#160; &#160; function1()</pre>
<pre>def function3():<br />&#160; &#160; try:<br />&#160; &#160; &#160; &#160; function2()<br />&#160; &#160; except Exception:<br />&#160; &#160; &#160; &#160; print_full_stack()</pre>
<pre>def function4():<br />&#160; &#160; function3()</pre>
<pre>def function5():<br />&#160; &#160; function4()</pre>
<pre>function5()</pre>
</blockquote>
<p>The final result would now be:</p>
<blockquote>
<pre>Traceback (most recent call last):<br />&#160; File "generate-5.py", line 32, in &lt;module&gt;<br />&#160; &#160; function5()<br />&#160; File "generate-5.py", line 30, in function5<br />&#160; &#160; function4()<br />&#160; File "generate-5.py", line 27, in function4<br />&#160; &#160; function3()<br />&#160; File "generate-5.py", line 22, in function3<br />&#160; &#160; function2()<br />&#160; File "generate-5.py", line 18, in function2<br />&#160; &#160; function1()<br />&#160; File "generate-5.py", line 15, in function1<br />&#160; &#160; raise RuntimeError('xxx')</pre>
</blockquote>
<h1>Using the exception traceback</h1>
<p>We are done right? No.</p>
<p>In this case we have relied on functions from the 'inspect' module that rely on being called directly from within the 'except' block.</p>
<p>That is, for generating the outer stack frames for the current stack we always assume that we need to drop two stack frames from the result of calling 'inspect.stack()'.</p>
<p>For the inner stack frames from the exception, the 'inspect.trace()' function relies on there being an exception which is currently being handled.</p>
<p>That we are assuming we should skip two stack frames for the current stack is a little bit fragile. For example, consider the case where we don't actually call 'print_full_stack()' within the 'except' block itself.</p>
<blockquote>
<pre>def function1():<br />&#160; &#160; raise RuntimeError('xxx')</pre>
<pre>def function2():<br />&#160; &#160; function1()</pre>
<pre>def function3a():<br />&#160; &#160; print_full_stack()</pre>
<pre>def function3():<br />&#160; &#160; try:<br />&#160; &#160; &#160; &#160; function2()<br />&#160; &#160; except Exception:<br />&#160; &#160; &#160; &#160; function3a()</pre>
<pre>def function4():<br />&#160; &#160; function3()</pre>
<pre>def function5():<br />&#160; &#160; function4()</pre>
<pre>function5()</pre>
</blockquote>
<p>The result here is:</p>
<blockquote>
<pre>Traceback (most recent call last):<br />&#160; File "generate-6.py", line 35, in &lt;module&gt;<br />&#160; &#160; function5()<br />&#160; File "generate-6.py", line 33, in function5<br />&#160; &#160; function4()<br />&#160; File "generate-6.py", line 30, in function4<br />&#160; &#160; function3()<br />&#160; File "generate-6.py", line 27, in function3<br />&#160; &#160; function3a()<br />&#160; File "generate-6.py", line 25, in function3<br />&#160; &#160; function2()<br />&#160; File "generate-6.py", line 18, in function2<br />&#160; &#160; function1()<br />&#160; File "generate-6.py", line 15, in function1<br />&#160; &#160; raise RuntimeError('xxx')</pre>
</blockquote>
<p>As can be seen, we actually end up with an additional stack frame being inserted corresponding to 'function3a()' which we called within the 'except' block and which in turn called 'print_full_stack()'.</p>
<p>To ensure we do the right thing here we need to look at what 'inspect.stack()' and 'inspect.trace()' actually do.</p>
<blockquote>
<pre>def stack(context=1):<br />&#160; &#160; """Return a list of records for the stack above the caller's frame."""<br />&#160; &#160; return getouterframes(sys._getframe(1), context)</pre>
<pre>def trace(context=1):<br />&#160; &#160; """Return a list of records for the stack below the current exception."""<br />&#160; &#160; return getinnerframes(sys.exc_info()[2], context)</pre>
</blockquote>
<p>So the problem we have with the extra stack frame is that 'inspect.stack()' uses 'sys._getframe()' to grab the current stack. This is correct and what it is intended to do, but not really what we want. What we instead want is the outer stack frames corresponding to where the exception was caught.</p>
<p>As it turns out this is available as an attribute on the traceback object for the exception called 'tb_frame'. Learning from how these two functions are implemented, we can therefore change our function to print the full stack.</p>
<blockquote>
<pre>import sys<br />import inspect</pre>
<pre>def print_full_stack(tb=None):<br />&#160; &#160; if tb is None:<br />&#160; &#160; &#160; &#160; tb = sys.exc_info()[2]</pre>
<pre>&#160; &#160; print 'Traceback (most recent call last):'<br />&#160; &#160; for item in reversed(inspect.getouterframes(tb.tb_frame)[1:]):<br />&#160; &#160; &#160; &#160; print ' File "{1}", line {2}, in {3}\n'.format(*item),<br />&#160; &#160; &#160; &#160; for line in item[4]:<br />&#160; &#160; &#160; &#160; &#160; &#160; print ' ' + line.lstrip(),<br />&#160; &#160; &#160; &#160; for item in inspect.getinnerframes(tb):<br />&#160; &#160; &#160; &#160; &#160; &#160; print ' File "{1}", line {2}, in {3}\n'.format(*item),<br />&#160; &#160; &#160; &#160; for line in item[4]:<br />&#160; &#160; &#160; &#160; &#160; &#160; print ' ' + line.lstrip(),</pre>
<pre>def function1():<br />&#160; &#160; raise RuntimeError('xxx')</pre>
<pre>def function2():<br />&#160; &#160; function1()</pre>
<pre>def function3a():<br />&#160; &#160; print_full_stack()</pre>
<pre>def function3():<br />&#160; &#160; try:<br />&#160; &#160; &#160; &#160; function2()<br />&#160; &#160; except Exception:<br />&#160; &#160; &#160; &#160; function3a()</pre>
<pre>def function4():<br />&#160; &#160; function3()</pre>
<pre>def function5():<br />&#160; &#160; function4()</pre>
<pre>function5()</pre>
</blockquote>
<p>We are now back to the desired result we are after.</p>
<blockquote>
<pre>Traceback (most recent call last):<br />&#160; File "generate-7.py", line 39, in &lt;module&gt;<br />&#160; &#160; function5()<br />&#160; File "generate-7.py", line 37, in function5<br />&#160; &#160; function4()<br />&#160; File "generate-7.py", line 34, in function4<br />&#160; &#160; function3()<br />&#160; File "generate-7.py", line 29, in function3<br />&#160; &#160; function2()<br />&#160; File "generate-7.py", line 22, in function2<br />&#160; &#160; function1()<br />&#160; File "generate-7.py", line 19, in function1<br />&#160; &#160; raise RuntimeError('xxx')</pre>
</blockquote>
<h1>Using a saved traceback</h1>
<p>In making this last modification we actually implemented 'print_full_stack()' to optionally accept an existing traceback. If none was supplied then we would instead use the traceback for the current exception being handled.</p>
<p>It is likely a rare situation where it would be required, but this allows one to pass in a traceback object which had been saved away and retained beyond the life of the 'try/except' block which generated it.</p>
<p>Be aware though that doing this can generate some surprising results.</p>
<blockquote>
<pre>def function1():<br />&#160; &#160; raise RuntimeError('xxx')</pre>
<pre>def function2():<br />&#160; &#160; function1()</pre>
<pre>def function3():<br />&#160; &#160; try:<br />&#160; &#160; &#160; &#160; function2()<br />&#160; &#160; except Exception:<br />&#160; &#160; &#160; &#160; return sys.exc_info()[2]</pre>
<pre>def function4():<br />&#160; &#160; &#160;tb = function3()<br />&#160; &#160; &#160;print_full_stack(tb)</pre>
<pre>def function5():<br />&#160; &#160; &#160;function4()</pre>
<pre>function5()</pre>
</blockquote>
<p>In this case we return the traceback to an outer scope and only within that outer function attempt to print out the full stack for the exception.</p>
<blockquote>
<pre>Traceback (most recent call last):<br />&#160; File "generate-8.py", line 37, in &lt;module&gt;<br />&#160; &#160; function5()<br />&#160; File "generate-8.py", line 35, in function5<br />&#160; &#160; function4()<br />&#160; File "generate-8.py", line 32, in function4<br />&#160; &#160; print_full_stack(tb)<br />&#160; File "generate-8.py", line 26, in function3<br />&#160; &#160; function2()<br />&#160; File "generate-8.py", line 22, in function2<br />&#160; &#160; function1()<br />&#160; File "generate-8.py", line 19, in function1<br />&#160; &#160; raise RuntimeError('xxx')</pre>
</blockquote>
<p>The problem here is that in 'function4()' rather than seeing the line where the call to 'function3()' was made, we see where the call to 'print_full_stack()' is made.</p>
<p>The reason for this is that although the traceback contains a snapshot of information from the current stack at the time of the exception, this only extends back as far as the 'try/except' block.</p>
<p>When we are accessing 'tb.tb_frame' and getting the outer frames, it is still accessing potentially active stack frames for any currently executing code.</p>
<p>So what has happened is that in looking at the stack frame for 'function4()' it is picking up the current execution line number at that point in time, which has shifted from the time when the original exception occurred. That is, control returned back into 'function4()' and execution progressed to the next line and the call 'print_full_stack()'.</p>
<p>Although the ability to print the full stack trace for the exception is useful, it is only reliable if called within the same function that the 'try/except' block existed. If you return the traceback object to an outer function and then try and produce the full stack, line number information in the outer stack frames can be wrong, due to the code execution point within those functions shifting if subsequent code in those functions had been executed since the exception occurred.</p>
<p>If anyone knows a way around this, beyond creating a snapshot of the full stack within the same function as where the 'try/except' occurred, I would be interested to hear how. My current understanding is that there isn't any way and it is just a limitation one has to live with in that case.</p>
<div style='clear: both;'></div>
</div>
<div class='post-footer'>
<div class='post-footer-line post-footer-line-1'>
<span class='post-author vcard'>
Posted by
<span class='fn' itemprop='author' itemscope='itemscope' itemtype='http://schema.org/Person'>
<meta content='https://www.blogger.com/profile/13609779138164842374' itemprop='url'/>
<a class='g-profile' href='https://www.blogger.com/profile/13609779138164842374' rel='author' title='author profile'>
<span itemprop='name'>Graham Dumpleton</span>
</a>
</span>
</span>
<span class='post-timestamp'>
at
<meta content='http://blog.dscpl.com.au/2015/03/generating-full-stack-traces-for.html' itemprop='url'/>
<a class='timestamp-link' href='http://blog.dscpl.com.au/2015/03/generating-full-stack-traces-for.html' rel='bookmark' title='permanent link'><abbr class='published' itemprop='datePublished' title='2015-03-21T23:36:00+11:00'>11:36&#8239;PM</abbr></a>
</span>
<span class='post-comment-link'>
</span>
<span class='post-icons'>
<span class='item-action'>
<a href='https://www.blogger.com/email-post/2363643920942057324/7672746776551574219' title='Email Post'>
<img alt='' class='icon-action' height='13' src='https://resources.blogblog.com/img/icon18_email.gif' width='18'/>
</a>
</span>
</span>
<div class='post-share-buttons goog-inline-block'>
<a class='goog-inline-block share-button sb-email' href='https://www.blogger.com/share-post.g?blogID=2363643920942057324&postID=7672746776551574219&target=email' target='_blank' title='Email This'><span class='share-button-link-text'>Email This</span></a><a class='goog-inline-block share-button sb-blog' href='https://www.blogger.com/share-post.g?blogID=2363643920942057324&postID=7672746776551574219&target=blog' onclick='window.open(this.href, "_blank", "height=270,width=475"); return false;' target='_blank' title='BlogThis!'><span class='share-button-link-text'>BlogThis!</span></a><a class='goog-inline-block share-button sb-twitter' href='https://www.blogger.com/share-post.g?blogID=2363643920942057324&postID=7672746776551574219&target=twitter' target='_blank' title='Share to X'><span class='share-button-link-text'>Share to X</span></a><a class='goog-inline-block share-button sb-facebook' href='https://www.blogger.com/share-post.g?blogID=2363643920942057324&postID=7672746776551574219&target=facebook' onclick='window.open(this.href, "_blank", "height=430,width=640"); return false;' target='_blank' title='Share to Facebook'><span class='share-button-link-text'>Share to Facebook</span></a><a class='goog-inline-block share-button sb-pinterest' href='https://www.blogger.com/share-post.g?blogID=2363643920942057324&postID=7672746776551574219&target=pinterest' target='_blank' title='Share to Pinterest'><span class='share-button-link-text'>Share to Pinterest</span></a>
</div>
</div>
<div class='post-footer-line post-footer-line-2'>
<span class='post-labels'>
Labels:
<a href='http://blog.dscpl.com.au/search/label/python' rel='tag'>python</a>
</span>
</div>
<div class='post-footer-line post-footer-line-3'>
<span class='post-location'>
</span>
</div>
</div>
</div>
<div class='comments' id='comments'>
<a name='comments'></a>
<h4>10 comments:</h4>
<div id='Blog1_comments-block-wrapper'>
<dl class='avatar-comment-indent' id='comments-block'>
<dt class='comment-author ' id='c3250530999419655111'>
<a name='c3250530999419655111'></a>
<div class="avatar-image-container avatar-stock"><span dir="ltr"><a href="https://www.blogger.com/profile/18332381064910373026" target="" rel="nofollow" onclick="" class="avatar-hovercard" id="av-3250530999419655111-18332381064910373026"><img src="//www.blogger.com/img/blogger_logo_round_35.png" width="35" height="35" alt="" title="Deron Meranda">

</a></span></div>
<a href='https://www.blogger.com/profile/18332381064910373026' rel='nofollow'>Deron Meranda</a>
said...
</dt>
<dd class='comment-body' id='Blog1_cmt-3250530999419655111'>
<p>
Also, what about Python 3&#39;s Exception Chaining (PEP 3134)?<br /><br />I have a library that provides hooks via user-supplied callbacks; and if the callback raises an exception, it gets repackaged in my own exception type with a chain to the original exception.  To allow the library to work in both Python 2 and 3 (even with 2to3) I manually construct the chain, such as this in Python 2 syntax:<br /><br />try:<br />    call_callback()<br />except Exception, err:<br />    e2 = sys.exc_info()<br />    newerr = MyException( ..stuff.. )<br />    newerr.__cause__ = err<br />    newerr.__traceback__ = e2[2]<br />    raise newerr<br /><br />Is this a good method, or am I loosing information?
</p>
</dd>
<dd class='comment-footer'>
<span class='comment-timestamp'>
<a href='http://blog.dscpl.com.au/2015/03/generating-full-stack-traces-for.html?showComment=1426956591144#c3250530999419655111' title='comment permalink'>
March 22, 2015 at 3:49&#8239;AM
</a>
<span class='item-control blog-admin pid-1494588428'>
<a class='comment-delete' href='https://www.blogger.com/comment/delete/2363643920942057324/3250530999419655111' title='Delete Comment'>
<img src='https://resources.blogblog.com/img/icon_delete13.gif'/>
</a>
</span>
</span>
</dd>
<dt class='comment-author blog-author' id='c8228269230229987543'>
<a name='c8228269230229987543'></a>
<div class="avatar-image-container avatar-stock"><span dir="ltr"><a href="https://www.blogger.com/profile/13609779138164842374" target="" rel="nofollow" onclick="" class="avatar-hovercard" id="av-8228269230229987543-13609779138164842374"><img src="//www.blogger.com/img/blogger_logo_round_35.png" width="35" height="35" alt="" title="Graham Dumpleton">

</a></span></div>
<a href='https://www.blogger.com/profile/13609779138164842374' rel='nofollow'>Graham Dumpleton</a>
said...
</dt>
<dd class='comment-body' id='Blog1_cmt-8228269230229987543'>
<p>
With chaining of exceptions, because the traceback of initial exceptions would be retained beyond the life of the try/except for those when re-raising a different exception, I would imaging the issue described with line numbers not then being accurate for the outer stack frames would apply.
</p>
</dd>
<dd class='comment-footer'>
<span class='comment-timestamp'>
<a href='http://blog.dscpl.com.au/2015/03/generating-full-stack-traces-for.html?showComment=1427064909483#c8228269230229987543' title='comment permalink'>
March 23, 2015 at 9:55&#8239;AM
</a>
<span class='item-control blog-admin pid-1526776468'>
<a class='comment-delete' href='https://www.blogger.com/comment/delete/2363643920942057324/8228269230229987543' title='Delete Comment'>
<img src='https://resources.blogblog.com/img/icon_delete13.gif'/>
</a>
</span>
</span>
</dd>
<dt class='comment-author ' id='c1179415365958851471'>
<a name='c1179415365958851471'></a>
<div class="avatar-image-container avatar-stock"><span dir="ltr"><a href="https://www.blogger.com/profile/09529158749729184143" target="" rel="nofollow" onclick="" class="avatar-hovercard" id="av-1179415365958851471-09529158749729184143"><img src="//www.blogger.com/img/blogger_logo_round_35.png" width="35" height="35" alt="" title="Piotr Dobrogost">

</a></span></div>
<a href='https://www.blogger.com/profile/09529158749729184143' rel='nofollow'>Piotr Dobrogost</a>
said...
</dt>
<dd class='comment-body' id='Blog1_cmt-1179415365958851471'>
<p>
It seems <i>creating a snapshot of the full stack within the same function as where the &#39;try/except&#39; occurred</i> is really the only way to provide full context of exception. The question is why Python itself does not do this and attach this snapshot to exception? I guess this might be to avoid cost of taking snapshot. If this is the case then Python should provide hook called every time a catch clause is entered. Related is http://stackoverflow.com/questions/1029318/calling-a-hook-function-every-time-an-exception-is-raised. I encourage you to take this problem to python-ideas to see if there&#39;s a chance of improving this aspect of language. Stack trace is crucial information and Python should really provide easy way to get it.<br /><br />I&#39;m also wondering if (contrary to Alex Martelli&#39;s statement in above SO thread) you found a way to monkey patch Python itself, obtaining missing hook I described above as result...
</p>
</dd>
<dd class='comment-footer'>
<span class='comment-timestamp'>
<a href='http://blog.dscpl.com.au/2015/03/generating-full-stack-traces-for.html?showComment=1427365838950#c1179415365958851471' title='comment permalink'>
March 26, 2015 at 9:30&#8239;PM
</a>
<span class='item-control blog-admin pid-335656336'>
<a class='comment-delete' href='https://www.blogger.com/comment/delete/2363643920942057324/1179415365958851471' title='Delete Comment'>
<img src='https://resources.blogblog.com/img/icon_delete13.gif'/>
</a>
</span>
</span>
</dd>
<dt class='comment-author blog-author' id='c2792610626743454134'>
<a name='c2792610626743454134'></a>
<div class="avatar-image-container avatar-stock"><span dir="ltr"><a href="https://www.blogger.com/profile/13609779138164842374" target="" rel="nofollow" onclick="" class="avatar-hovercard" id="av-2792610626743454134-13609779138164842374"><img src="//www.blogger.com/img/blogger_logo_round_35.png" width="35" height="35" alt="" title="Graham Dumpleton">

</a></span></div>
<a href='https://www.blogger.com/profile/13609779138164842374' rel='nofollow'>Graham Dumpleton</a>
said...
</dt>
<dd class='comment-body' id='Blog1_cmt-2792610626743454134'>
<p>
No, there is no one way of being able to patch Python at that level without changing the C code of the interpreter itself.
</p>
</dd>
<dd class='comment-footer'>
<span class='comment-timestamp'>
<a href='http://blog.dscpl.com.au/2015/03/generating-full-stack-traces-for.html?showComment=1427366740408#c2792610626743454134' title='comment permalink'>
March 26, 2015 at 9:45&#8239;PM
</a>
<span class='item-control blog-admin pid-1526776468'>
<a class='comment-delete' href='https://www.blogger.com/comment/delete/2363643920942057324/2792610626743454134' title='Delete Comment'>
<img src='https://resources.blogblog.com/img/icon_delete13.gif'/>
</a>
</span>
</span>
</dd>
<dt class='comment-author ' id='c1722273257065501315'>
<a name='c1722273257065501315'></a>
<div class="avatar-image-container avatar-stock"><span dir="ltr"><a href="https://www.blogger.com/profile/09529158749729184143" target="" rel="nofollow" onclick="" class="avatar-hovercard" id="av-1722273257065501315-09529158749729184143"><img src="//www.blogger.com/img/blogger_logo_round_35.png" width="35" height="35" alt="" title="Piotr Dobrogost">

</a></span></div>
<a href='https://www.blogger.com/profile/09529158749729184143' rel='nofollow'>Piotr Dobrogost</a>
said...
</dt>
<dd class='comment-body' id='Blog1_cmt-1722273257065501315'>
<p>
And what do you think about idea of Python provided hook called upon entering except/finally block?
</p>
</dd>
<dd class='comment-footer'>
<span class='comment-timestamp'>
<a href='http://blog.dscpl.com.au/2015/03/generating-full-stack-traces-for.html?showComment=1427382645483#c1722273257065501315' title='comment permalink'>
March 27, 2015 at 2:10&#8239;AM
</a>
<span class='item-control blog-admin pid-335656336'>
<a class='comment-delete' href='https://www.blogger.com/comment/delete/2363643920942057324/1722273257065501315' title='Delete Comment'>
<img src='https://resources.blogblog.com/img/icon_delete13.gif'/>
</a>
</span>
</span>
</dd>
<dt class='comment-author blog-author' id='c8307351316519777926'>
<a name='c8307351316519777926'></a>
<div class="avatar-image-container avatar-stock"><span dir="ltr"><a href="https://www.blogger.com/profile/13609779138164842374" target="" rel="nofollow" onclick="" class="avatar-hovercard" id="av-8307351316519777926-13609779138164842374"><img src="//www.blogger.com/img/blogger_logo_round_35.png" width="35" height="35" alt="" title="Graham Dumpleton">

</a></span></div>
<a href='https://www.blogger.com/profile/13609779138164842374' rel='nofollow'>Graham Dumpleton</a>
said...
</dt>
<dd class='comment-body' id='Blog1_cmt-8307351316519777926'>
<p>
One could possibly argue the case for a sys.setexcept()/sys.getexpect() hooking mechanism in the same vain as those for profile and trace call backs, but would want to see the good use case for it.<br /><br />A problem noted on SO is how you distinguish an internal implementation detail where the exception is caught and suppressed automatically such as StopIteration, AttributeError on getattr() failure etc etc.<br /><br />Having a callback could easily lead to making it easy for users to cause problems if used poorly, but then that situation exists with the profile and trace hooks now.<br /><br />So am not fore or against.
</p>
</dd>
<dd class='comment-footer'>
<span class='comment-timestamp'>
<a href='http://blog.dscpl.com.au/2015/03/generating-full-stack-traces-for.html?showComment=1427417550168#c8307351316519777926' title='comment permalink'>
March 27, 2015 at 11:52&#8239;AM
</a>
<span class='item-control blog-admin pid-1526776468'>
<a class='comment-delete' href='https://www.blogger.com/comment/delete/2363643920942057324/8307351316519777926' title='Delete Comment'>
<img src='https://resources.blogblog.com/img/icon_delete13.gif'/>
</a>
</span>
</span>
</dd>
<dt class='comment-author ' id='c221806409423818641'>
<a name='c221806409423818641'></a>
<div class="avatar-image-container avatar-stock"><span dir="ltr"><a href="https://www.blogger.com/profile/00266664518110871670" target="" rel="nofollow" onclick="" class="avatar-hovercard" id="av-221806409423818641-00266664518110871670"><img src="//www.blogger.com/img/blogger_logo_round_35.png" width="35" height="35" alt="" title="guettli">

</a></span></div>
<a href='https://www.blogger.com/profile/00266664518110871670' rel='nofollow'>guettli</a>
said...
</dt>
<dd class='comment-body' id='Blog1_cmt-221806409423818641'>
<p>
I wanted to see the upper frames some months ago. The issue I created was solved in Python3. I never tried the solution since I am still fixed on Python2. Issue: https://bugs.python.org/issue9427
</p>
</dd>
<dd class='comment-footer'>
<span class='comment-timestamp'>
<a href='http://blog.dscpl.com.au/2015/03/generating-full-stack-traces-for.html?showComment=1433485829841#c221806409423818641' title='comment permalink'>
June 5, 2015 at 4:30&#8239;PM
</a>
<span class='item-control blog-admin pid-794994835'>
<a class='comment-delete' href='https://www.blogger.com/comment/delete/2363643920942057324/221806409423818641' title='Delete Comment'>
<img src='https://resources.blogblog.com/img/icon_delete13.gif'/>
</a>
</span>
</span>
</dd>
<dt class='comment-author ' id='c7148103652676574126'>
<a name='c7148103652676574126'></a>
<div class="avatar-image-container avatar-stock"><span dir="ltr"><img src="//resources.blogblog.com/img/blank.gif" width="35" height="35" alt="" title="Anonymous">

</span></div>
Anonymous
said...
</dt>
<dd class='comment-body' id='Blog1_cmt-7148103652676574126'>
<p>
I had the same problem last day, but worse because of threading<br /><br />Here my solution:<br /><br />def get_stack(skip=1, tb=None):<br />    stack = traceback.extract_stack()[:-(1+skip)]<br /><br />    # if we are in a properly created thread, preprend the thread stack<br />    if hasattr(threading.current_thread(), &quot;_stack&quot;):<br />        stack = getattr(threading.current_thread(), &quot;_stack&quot;) + stack<br /><br />    # Remove threading init calls<br />    threading_lib_path = threading.__file__.rstrip(&quot;c&quot;)<br />    stack = filter(lambda x : x[0] != threading_lib_path, stack)<br /><br />    if tb:<br />        stack += tb<br />    else:<br />        # complete stack with the real exception launcher if exists<br />        err_tb = sys.exc_info()[2]<br />        if err_tb is not None:<br />            stack += traceback.extract_tb(err_tb)<br />            del err_tb<br /><br />    #return result<br />    return stack<br /><br />def create_thread(*args, **kwargs):<br />    thread = threading.Thread(*args, **kwargs)<br />    setattr(thread, &quot;_stack&quot;, get_stack())<br />    return thread<br /><br /><br />It&#39;s far from perfect, but I don&#39;t know make better<br />I hope it can help someone<br /><br />
</p>
</dd>
<dd class='comment-footer'>
<span class='comment-timestamp'>
<a href='http://blog.dscpl.com.au/2015/03/generating-full-stack-traces-for.html?showComment=1486088545689#c7148103652676574126' title='comment permalink'>
February 3, 2017 at 1:22&#8239;PM
</a>
<span class='item-control blog-admin pid-159164253'>
<a class='comment-delete' href='https://www.blogger.com/comment/delete/2363643920942057324/7148103652676574126' title='Delete Comment'>
<img src='https://resources.blogblog.com/img/icon_delete13.gif'/>
</a>
</span>
</span>
</dd>
<dt class='comment-author ' id='c5212138471780742479'>
<a name='c5212138471780742479'></a>
<div class="avatar-image-container avatar-stock"><span dir="ltr"><a href="https://www.blogger.com/profile/01879066589943384553" target="" rel="nofollow" onclick="" class="avatar-hovercard" id="av-5212138471780742479-01879066589943384553"><img src="//www.blogger.com/img/blogger_logo_round_35.png" width="35" height="35" alt="" title="Delgan">

</a></span></div>
<a href='https://www.blogger.com/profile/01879066589943384553' rel='nofollow'>Delgan</a>
said...
</dt>
<dd class='comment-body' id='Blog1_cmt-5212138471780742479'>
<p>
Hi, thanks for this article which helped me to better understand how traceback, stacks and exceptions work in Python.<br /><br />One possible and elegant solution to the problem is to walk back trough the stack and create fake tracebacks which could be preprended to the actual traceback got from &quot;sys.exc_info&quot;. That way, the traceback starts from the root and continues to the error fluently.<br /><br />This is described in this StackOverflow answer: https://stackoverflow.com/a/13210518/2291710<br /><br />I actually implemented it before I saw the SO question, it looked like this:<br /><br /><i><br />class fake_traceback:<br /><br />&#12288;&#12288;def __init__(self, frame, lasti, lineno, next_=None):<br />&#12288;&#12288;&#12288;&#12288;self.tb_frame = frame<br />&#12288;&#12288;&#12288;&#12288;self.tb_lasti = lasti<br />&#12288;&#12288;&#12288;&#12288;self.tb_lineno = lineno<br />&#12288;&#12288;&#12288;&#12288;self.tb_next = next_<br /><br />def function3():<br />&#12288;&#12288;try:<br />&#12288;&#12288;&#12288;&#12288;function2()<br />&#12288;&#12288;except:<br />&#12288;&#12288;&#12288;&#12288;etype, ex, tb = sys.exc_info()<br />&#12288;&#12288;&#12288;&#12288;tb = fake_traceback(tb.tb_frame, tb.tb_lasti, tb.tb_lineno, tb.tb_next)<br />&#12288;&#12288;&#12288;&#12288;frame = tb.tb_frame.f_back<br />&#12288;&#12288;&#12288;&#12288;while frame:<br />&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;tb = fake_traceback(frame, frame.f_lasti, frame.f_lineno, tb)<br />&#12288;&#12288;&#12288;&#12288;&#12288;&#12288;frame = frame.f_back<br />        <br />&#12288;&#12288;&#12288;&#12288;print(&#39;&#39;.join(traceback.format_tb(tb)))<br /></i><br />
</p>
</dd>
<dd class='comment-footer'>
<span class='comment-timestamp'>
<a href='http://blog.dscpl.com.au/2015/03/generating-full-stack-traces-for.html?showComment=1509457827102#c5212138471780742479' title='comment permalink'>
November 1, 2017 at 12:50&#8239;AM
</a>
<span class='item-control blog-admin pid-1518822452'>
<a class='comment-delete' href='https://www.blogger.com/comment/delete/2363643920942057324/5212138471780742479' title='Delete Comment'>
<img src='https://resources.blogblog.com/img/icon_delete13.gif'/>
</a>
</span>
</span>
</dd>
<dt class='comment-author ' id='c5144835884908107248'>
<a name='c5144835884908107248'></a>
<div class="avatar-image-container avatar-stock"><span dir="ltr"><a href="https://www.blogger.com/profile/04833014792035469716" target="" rel="nofollow" onclick="" class="avatar-hovercard" id="av-5144835884908107248-04833014792035469716"><img src="//www.blogger.com/img/blogger_logo_round_35.png" width="35" height="35" alt="" title="Michael Herrmann">

</a></span></div>
<a href='https://www.blogger.com/profile/04833014792035469716' rel='nofollow'>Michael Herrmann</a>
said...
</dt>
<dd class='comment-body' id='Blog1_cmt-5144835884908107248'>
<p>
I encountered this problem while developing a GUI app with PyQt. For other people with the same setup, I wrote a <a href="https://fman.io/blog/pyqt-excepthook/" rel="nofollow">blog post</a> with a solution mirroring the one by Adrien above. Maybe it will spare someone the hours I just spent!
</p>
</dd>
<dd class='comment-footer'>
<span class='comment-timestamp'>
<a href='http://blog.dscpl.com.au/2015/03/generating-full-stack-traces-for.html?showComment=1522342269537#c5144835884908107248' title='comment permalink'>
March 30, 2018 at 3:51&#8239;AM
</a>
<span class='item-control blog-admin pid-1753889542'>
<a class='comment-delete' href='https://www.blogger.com/comment/delete/2363643920942057324/5144835884908107248' title='Delete Comment'>
<img src='https://resources.blogblog.com/img/icon_delete13.gif'/>
</a>
</span>
</span>
</dd>
</dl>
</div>
<p class='comment-footer'>
<a href='https://www.blogger.com/comment/fullpage/post/2363643920942057324/7672746776551574219' onclick=''>Post a Comment</a>
</p>
</div>
</div>

        </div></div>
      
</div>
<div class='blog-pager' id='blog-pager'>
<span id='blog-pager-newer-link'>
<a class='blog-pager-newer-link' href='http://blog.dscpl.com.au/2015/04/introducing-modwsgi-express.html' id='Blog1_blog-pager-newer-link' title='Newer Post'>Newer Post</a>
</span>
<span id='blog-pager-older-link'>
<a class='blog-pager-older-link' href='http://blog.dscpl.com.au/2015/03/ordering-issues-when-monkey-patching-in.html' id='Blog1_blog-pager-older-link' title='Older Post'>Older Post</a>
</span>
<a class='home-link' href='http://blog.dscpl.com.au/'>Home</a>
</div>
<div class='clear'></div>
<div class='post-feeds'>
<div class='feed-links'>
Subscribe to:
<a class='feed-link' href='http://blog.dscpl.com.au/feeds/7672746776551574219/comments/default' target='_blank' type='application/atom+xml'>Post Comments (Atom)</a>
</div>
</div>
</div></div>
</div>
</div>
<div class='column-left-outer'>
<div class='column-left-inner'>
<aside>
</aside>
</div>
</div>
<div class='column-right-outer'>
<div class='column-right-inner'>
<aside>
<div class='sidebar section' id='sidebar-right-1'><div class='widget Profile' data-version='1' id='Profile1'>
<h2>About Me</h2>
<div class='widget-content'>
<dl class='profile-datablock'>
<dt class='profile-data'>
<a class='profile-name-link g-profile' href='https://www.blogger.com/profile/13609779138164842374' rel='author' style='background-image: url(//www.blogger.com/img/logo-16.png);'>
Graham Dumpleton
</a>
</dt>
</dl>
<a class='profile-link' href='https://www.blogger.com/profile/13609779138164842374' rel='author'>View my complete profile</a>
<div class='clear'></div>
</div>
</div><div class='widget PageList' data-version='1' id='PageList1'>
<h2>Quick Links</h2>
<div class='widget-content'>
<ul>
<li>
<a href='http://blog.dscpl.com.au/p/decorators-and-monkey-patching.html'>Decorators and monkey patching.</a>
</li>
<li>
<a href='http://blog.dscpl.com.au/p/using-python-with-docker.html'>Using Python with Docker.</a>
</li>
</ul>
<div class='clear'></div>
</div>
</div><div class='widget BlogArchive' data-version='1' id='BlogArchive1'>
<h2>Blog Archive</h2>
<div class='widget-content'>
<div id='ArchiveList'>
<div id='BlogArchive1_ArchiveList'>
<select id='BlogArchive1_ArchiveMenu'>
<option value=''>Blog Archive</option>
<option value='http://blog.dscpl.com.au/2019/01/'>January (3)</option>
<option value='http://blog.dscpl.com.au/2018/12/'>December (4)</option>
<option value='http://blog.dscpl.com.au/2018/10/'>October (1)</option>
<option value='http://blog.dscpl.com.au/2018/04/'>April (1)</option>
<option value='http://blog.dscpl.com.au/2018/01/'>January (1)</option>
<option value='http://blog.dscpl.com.au/2017/04/'>April (1)</option>
<option value='http://blog.dscpl.com.au/2016/12/'>December (2)</option>
<option value='http://blog.dscpl.com.au/2016/08/'>August (1)</option>
<option value='http://blog.dscpl.com.au/2016/07/'>July (1)</option>
<option value='http://blog.dscpl.com.au/2016/04/'>April (2)</option>
<option value='http://blog.dscpl.com.au/2016/03/'>March (1)</option>
<option value='http://blog.dscpl.com.au/2016/02/'>February (2)</option>
<option value='http://blog.dscpl.com.au/2016/01/'>January (3)</option>
<option value='http://blog.dscpl.com.au/2015/12/'>December (6)</option>
<option value='http://blog.dscpl.com.au/2015/10/'>October (1)</option>
<option value='http://blog.dscpl.com.au/2015/08/'>August (1)</option>
<option value='http://blog.dscpl.com.au/2015/07/'>July (2)</option>
<option value='http://blog.dscpl.com.au/2015/06/'>June (5)</option>
<option value='http://blog.dscpl.com.au/2015/05/'>May (7)</option>
<option value='http://blog.dscpl.com.au/2015/04/'>April (4)</option>
<option value='http://blog.dscpl.com.au/2015/03/'>March (4)</option>
<option value='http://blog.dscpl.com.au/2015/01/'>January (2)</option>
<option value='http://blog.dscpl.com.au/2014/12/'>December (4)</option>
<option value='http://blog.dscpl.com.au/2014/11/'>November (1)</option>
<option value='http://blog.dscpl.com.au/2014/09/'>September (7)</option>
<option value='http://blog.dscpl.com.au/2014/08/'>August (1)</option>
<option value='http://blog.dscpl.com.au/2014/05/'>May (1)</option>
<option value='http://blog.dscpl.com.au/2014/04/'>April (1)</option>
<option value='http://blog.dscpl.com.au/2014/02/'>February (4)</option>
<option value='http://blog.dscpl.com.au/2014/01/'>January (8)</option>
<option value='http://blog.dscpl.com.au/2013/12/'>December (1)</option>
<option value='http://blog.dscpl.com.au/2012/12/'>December (1)</option>
<option value='http://blog.dscpl.com.au/2012/10/'>October (4)</option>
<option value='http://blog.dscpl.com.au/2012/08/'>August (1)</option>
<option value='http://blog.dscpl.com.au/2011/11/'>November (1)</option>
<option value='http://blog.dscpl.com.au/2011/10/'>October (1)</option>
<option value='http://blog.dscpl.com.au/2011/09/'>September (1)</option>
<option value='http://blog.dscpl.com.au/2011/03/'>March (1)</option>
<option value='http://blog.dscpl.com.au/2011/01/'>January (5)</option>
<option value='http://blog.dscpl.com.au/2010/12/'>December (2)</option>
<option value='http://blog.dscpl.com.au/2010/10/'>October (1)</option>
<option value='http://blog.dscpl.com.au/2010/08/'>August (2)</option>
<option value='http://blog.dscpl.com.au/2010/06/'>June (2)</option>
<option value='http://blog.dscpl.com.au/2010/05/'>May (2)</option>
<option value='http://blog.dscpl.com.au/2010/04/'>April (1)</option>
<option value='http://blog.dscpl.com.au/2010/03/'>March (3)</option>
<option value='http://blog.dscpl.com.au/2009/11/'>November (4)</option>
<option value='http://blog.dscpl.com.au/2009/10/'>October (3)</option>
<option value='http://blog.dscpl.com.au/2009/09/'>September (1)</option>
<option value='http://blog.dscpl.com.au/2009/08/'>August (3)</option>
<option value='http://blog.dscpl.com.au/2009/05/'>May (2)</option>
<option value='http://blog.dscpl.com.au/2009/04/'>April (5)</option>
<option value='http://blog.dscpl.com.au/2009/03/'>March (5)</option>
<option value='http://blog.dscpl.com.au/2009/02/'>February (1)</option>
<option value='http://blog.dscpl.com.au/2008/12/'>December (2)</option>
<option value='http://blog.dscpl.com.au/2008/08/'>August (1)</option>
<option value='http://blog.dscpl.com.au/2008/03/'>March (1)</option>
<option value='http://blog.dscpl.com.au/2007/11/'>November (2)</option>
<option value='http://blog.dscpl.com.au/2007/10/'>October (3)</option>
<option value='http://blog.dscpl.com.au/2007/09/'>September (3)</option>
<option value='http://blog.dscpl.com.au/2007/08/'>August (1)</option>
<option value='http://blog.dscpl.com.au/2007/07/'>July (2)</option>
<option value='http://blog.dscpl.com.au/2007/03/'>March (2)</option>
</select>
</div>
</div>
<div class='clear'></div>
</div>
</div><div class='widget Label' data-version='1' id='Label1'>
<h2>Labels</h2>
<div class='widget-content list-label-widget-content'>
<ul>
<li>
<a dir='ltr' href='http://blog.dscpl.com.au/search/label/python'>python</a>
<span dir='ltr'>(111)</span>
</li>
<li>
<a dir='ltr' href='http://blog.dscpl.com.au/search/label/mod_wsgi'>mod_wsgi</a>
<span dir='ltr'>(86)</span>
</li>
<li>
<a dir='ltr' href='http://blog.dscpl.com.au/search/label/wsgi'>wsgi</a>
<span dir='ltr'>(58)</span>
</li>
<li>
<a dir='ltr' href='http://blog.dscpl.com.au/search/label/apache'>apache</a>
<span dir='ltr'>(35)</span>
</li>
<li>
<a dir='ltr' href='http://blog.dscpl.com.au/search/label/docker'>docker</a>
<span dir='ltr'>(34)</span>
</li>
<li>
<a dir='ltr' href='http://blog.dscpl.com.au/search/label/openshift'>openshift</a>
<span dir='ltr'>(26)</span>
</li>
<li>
<a dir='ltr' href='http://blog.dscpl.com.au/search/label/decorators'>decorators</a>
<span dir='ltr'>(15)</span>
</li>
<li>
<a dir='ltr' href='http://blog.dscpl.com.au/search/label/django'>django</a>
<span dir='ltr'>(13)</span>
</li>
<li>
<a dir='ltr' href='http://blog.dscpl.com.au/search/label/kubernetes'>kubernetes</a>
<span dir='ltr'>(12)</span>
</li>
<li>
<a dir='ltr' href='http://blog.dscpl.com.au/search/label/mod_python'>mod_python</a>
<span dir='ltr'>(9)</span>
</li>
<li>
<a dir='ltr' href='http://blog.dscpl.com.au/search/label/red%20hat'>red hat</a>
<span dir='ltr'>(9)</span>
</li>
<li>
<a dir='ltr' href='http://blog.dscpl.com.au/search/label/ipython'>ipython</a>
<span dir='ltr'>(7)</span>
</li>
<li>
<a dir='ltr' href='http://blog.dscpl.com.au/search/label/jupyterhub'>jupyterhub</a>
<span dir='ltr'>(7)</span>
</li>
<li>
<a dir='ltr' href='http://blog.dscpl.com.au/search/label/new%20relic'>new relic</a>
<span dir='ltr'>(6)</span>
</li>
<li>
<a dir='ltr' href='http://blog.dscpl.com.au/search/label/wrapt'>wrapt</a>
<span dir='ltr'>(6)</span>
</li>
<li>
<a dir='ltr' href='http://blog.dscpl.com.au/search/label/pycon'>pycon</a>
<span dir='ltr'>(5)</span>
</li>
<li>
<a dir='ltr' href='http://blog.dscpl.com.au/search/label/s2i'>s2i</a>
<span dir='ltr'>(4)</span>
</li>
<li>
<a dir='ltr' href='http://blog.dscpl.com.au/search/label/gunicorn'>gunicorn</a>
<span dir='ltr'>(3)</span>
</li>
<li>
<a dir='ltr' href='http://blog.dscpl.com.au/search/label/uWSGI'>uWSGI</a>
<span dir='ltr'>(3)</span>
</li>
<li>
<a dir='ltr' href='http://blog.dscpl.com.au/search/label/datadog'>datadog</a>
<span dir='ltr'>(2)</span>
</li>
<li>
<a dir='ltr' href='http://blog.dscpl.com.au/search/label/nginx'>nginx</a>
<span dir='ltr'>(2)</span>
</li>
<li>
<a dir='ltr' href='http://blog.dscpl.com.au/search/label/statsd'>statsd</a>
<span dir='ltr'>(2)</span>
</li>
<li>
<a dir='ltr' href='http://blog.dscpl.com.au/search/label/web2py'>web2py</a>
<span dir='ltr'>(2)</span>
</li>
<li>
<a dir='ltr' href='http://blog.dscpl.com.au/search/label/async'>async</a>
<span dir='ltr'>(1)</span>
</li>
<li>
<a dir='ltr' href='http://blog.dscpl.com.au/search/label/dyndns53'>dyndns53</a>
<span dir='ltr'>(1)</span>
</li>
<li>
<a dir='ltr' href='http://blog.dscpl.com.au/search/label/fastcgi'>fastcgi</a>
<span dir='ltr'>(1)</span>
</li>
<li>
<a dir='ltr' href='http://blog.dscpl.com.au/search/label/heroku'>heroku</a>
<span dir='ltr'>(1)</span>
</li>
<li>
<a dir='ltr' href='http://blog.dscpl.com.au/search/label/jupyter'>jupyter</a>
<span dir='ltr'>(1)</span>
</li>
<li>
<a dir='ltr' href='http://blog.dscpl.com.au/search/label/lektor'>lektor</a>
<span dir='ltr'>(1)</span>
</li>
<li>
<a dir='ltr' href='http://blog.dscpl.com.au/search/label/php'>php</a>
<span dir='ltr'>(1)</span>
</li>
<li>
<a dir='ltr' href='http://blog.dscpl.com.au/search/label/shiv'>shiv</a>
<span dir='ltr'>(1)</span>
</li>
<li>
<a dir='ltr' href='http://blog.dscpl.com.au/search/label/testing'>testing</a>
<span dir='ltr'>(1)</span>
</li>
<li>
<a dir='ltr' href='http://blog.dscpl.com.au/search/label/tornado'>tornado</a>
<span dir='ltr'>(1)</span>
</li>
<li>
<a dir='ltr' href='http://blog.dscpl.com.au/search/label/warpdrive'>warpdrive</a>
<span dir='ltr'>(1)</span>
</li>
<li>
<a dir='ltr' href='http://blog.dscpl.com.au/search/label/zipapp'>zipapp</a>
<span dir='ltr'>(1)</span>
</li>
</ul>
<div class='clear'></div>
</div>
</div></div>
</aside>
</div>
</div>
</div>
<div style='clear: both'></div>
<!-- columns -->
</div>
<!-- main -->
</div>
</div>
<div class='main-cap-bottom cap-bottom'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
</div>
<footer>
<div class='footer-outer'>
<div class='footer-cap-top cap-top'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
<div class='fauxborder-left footer-fauxborder-left'>
<div class='fauxborder-right footer-fauxborder-right'></div>
<div class='region-inner footer-inner'>
<div class='foot section' id='footer-1'><div class='widget AdSense' data-version='1' id='AdSense1'>
<div class='widget-content'>
<script type="text/javascript"><!--
google_ad_client="pub-6433235630058377";
google_ad_host="pub-1556223355139109";
google_ad_width=120;
google_ad_height=600;
google_ad_format="120x600_as";
google_ad_type="text";
google_ad_host_channel="0001";
google_color_border="FFFFFF";
google_color_bg="FFFFFF";
google_color_link="999999";
google_color_url="5588AA";
google_color_text="666666";
//--></script>
<script type="text/javascript"
  src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
<div class='clear'></div>
</div>
</div></div>
<table border='0' cellpadding='0' cellspacing='0' class='section-columns columns-2'>
<tbody>
<tr>
<td class='first columns-cell'>
<div class='foot no-items section' id='footer-2-1'></div>
</td>
<td class='columns-cell'>
<div class='foot no-items section' id='footer-2-2'></div>
</td>
</tr>
</tbody>
</table>
<!-- outside of the include in order to lock Attribution widget -->
<div class='foot section' id='footer-3' name='Footer'><div class='widget Attribution' data-version='1' id='Attribution1'>
<div class='widget-content' style='text-align: center;'>
Simple theme. Powered by <a href='https://www.blogger.com' target='_blank'>Blogger</a>.
</div>
<div class='clear'></div>
</div></div>
</div>
</div>
<div class='footer-cap-bottom cap-bottom'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
</div>
</footer>
<!-- content -->
</div>
</div>
<div class='content-cap-bottom cap-bottom'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
</div>
</div>
<script type='text/javascript'>
    window.setTimeout(function() {
        document.body.className = document.body.className.replace('loading', '');
      }, 10);
  </script>

<script type="text/javascript" src="https://www.blogger.com/static/v1/widgets/552934507-widgets.js"></script>
<script type='text/javascript'>
window['__wavt'] = 'AOuZoY7brFVv1OXvGKy4uBe9ZHSl-lJvaQ:1757390315422';_WidgetManager._Init('//www.blogger.com/rearrange?blogID\x3d2363643920942057324','//blog.dscpl.com.au/2015/03/generating-full-stack-traces-for.html','2363643920942057324');
_WidgetManager._SetDataContext([{'name': 'blog', 'data': {'blogId': '2363643920942057324', 'title': 'Graham Dumpleton', 'url': 'http://blog.dscpl.com.au/2015/03/generating-full-stack-traces-for.html', 'canonicalUrl': 'http://blog.dscpl.com.au/2015/03/generating-full-stack-traces-for.html', 'homepageUrl': 'http://blog.dscpl.com.au/', 'searchUrl': 'http://blog.dscpl.com.au/search', 'canonicalHomepageUrl': 'http://blog.dscpl.com.au/', 'blogspotFaviconUrl': 'http://blog.dscpl.com.au/favicon.ico', 'bloggerUrl': 'https://www.blogger.com', 'hasCustomDomain': true, 'httpsEnabled': false, 'enabledCommentProfileImages': true, 'gPlusViewType': 'FILTERED_POSTMOD', 'adultContent': false, 'analyticsAccountNumber': '', 'encoding': 'UTF-8', 'locale': 'en', 'localeUnderscoreDelimited': 'en', 'languageDirection': 'ltr', 'isPrivate': false, 'isMobile': false, 'isMobileRequest': false, 'mobileClass': '', 'isPrivateBlog': false, 'isDynamicViewsAvailable': true, 'feedLinks': '\x3clink rel\x3d\x22alternate\x22 type\x3d\x22application/atom+xml\x22 title\x3d\x22Graham Dumpleton - Atom\x22 href\x3d\x22http://blog.dscpl.com.au/feeds/posts/default\x22 /\x3e\n\x3clink rel\x3d\x22alternate\x22 type\x3d\x22application/rss+xml\x22 title\x3d\x22Graham Dumpleton - RSS\x22 href\x3d\x22http://blog.dscpl.com.au/feeds/posts/default?alt\x3drss\x22 /\x3e\n\x3clink rel\x3d\x22service.post\x22 type\x3d\x22application/atom+xml\x22 title\x3d\x22Graham Dumpleton - Atom\x22 href\x3d\x22https://www.blogger.com/feeds/2363643920942057324/posts/default\x22 /\x3e\n\n\x3clink rel\x3d\x22alternate\x22 type\x3d\x22application/atom+xml\x22 title\x3d\x22Graham Dumpleton - Atom\x22 href\x3d\x22http://blog.dscpl.com.au/feeds/7672746776551574219/comments/default\x22 /\x3e\n', 'meTag': '', 'adsenseClientId': 'ca-pub-6433235630058377', 'adsenseHostId': 'ca-host-pub-1556223355139109', 'adsenseHasAds': true, 'adsenseAutoAds': false, 'boqCommentIframeForm': true, 'loginRedirectParam': '', 'view': '', 'dynamicViewsCommentsSrc': '//www.blogblog.com/dynamicviews/4224c15c4e7c9321/js/comments.js', 'dynamicViewsScriptSrc': '//www.blogblog.com/dynamicviews/b4594f574ba3c273', 'plusOneApiSrc': 'https://apis.google.com/js/platform.js', 'disableGComments': true, 'interstitialAccepted': false, 'sharing': {'platforms': [{'name': 'Get link', 'key': 'link', 'shareMessage': 'Get link', 'target': ''}, {'name': 'Facebook', 'key': 'facebook', 'shareMessage': 'Share to Facebook', 'target': 'facebook'}, {'name': 'BlogThis!', 'key': 'blogThis', 'shareMessage': 'BlogThis!', 'target': 'blog'}, {'name': 'X', 'key': 'twitter', 'shareMessage': 'Share to X', 'target': 'twitter'}, {'name': 'Pinterest', 'key': 'pinterest', 'shareMessage': 'Share to Pinterest', 'target': 'pinterest'}, {'name': 'Email', 'key': 'email', 'shareMessage': 'Email', 'target': 'email'}], 'disableGooglePlus': true, 'googlePlusShareButtonWidth': 0, 'googlePlusBootstrap': '\x3cscript type\x3d\x22text/javascript\x22\x3ewindow.___gcfg \x3d {\x27lang\x27: \x27en\x27};\x3c/script\x3e'}, 'hasCustomJumpLinkMessage': false, 'jumpLinkMessage': 'Read more', 'pageType': 'item', 'postId': '7672746776551574219', 'pageName': 'Generating full stack traces for exceptions in Python.', 'pageTitle': 'Graham Dumpleton: Generating full stack traces for exceptions in Python.'}}, {'name': 'features', 'data': {}}, {'name': 'messages', 'data': {'edit': 'Edit', 'linkCopiedToClipboard': 'Link copied to clipboard!', 'ok': 'Ok', 'postLink': 'Post Link'}}, {'name': 'template', 'data': {'name': 'Simple', 'localizedName': 'Simple', 'isResponsive': false, 'isAlternateRendering': false, 'isCustom': false, 'variant': 'pale', 'variantId': 'pale'}}, {'name': 'view', 'data': {'classic': {'name': 'classic', 'url': '?view\x3dclassic'}, 'flipcard': {'name': 'flipcard', 'url': '?view\x3dflipcard'}, 'magazine': {'name': 'magazine', 'url': '?view\x3dmagazine'}, 'mosaic': {'name': 'mosaic', 'url': '?view\x3dmosaic'}, 'sidebar': {'name': 'sidebar', 'url': '?view\x3dsidebar'}, 'snapshot': {'name': 'snapshot', 'url': '?view\x3dsnapshot'}, 'timeslide': {'name': 'timeslide', 'url': '?view\x3dtimeslide'}, 'isMobile': false, 'title': 'Generating full stack traces for exceptions in Python.', 'description': 'My last few blog posts have been about monkey patching. I will be continuing with more posts on that topic, but I am going to take a slight ...', 'url': 'http://blog.dscpl.com.au/2015/03/generating-full-stack-traces-for.html', 'type': 'item', 'isSingleItem': true, 'isMultipleItems': false, 'isError': false, 'isPage': false, 'isPost': true, 'isHomepage': false, 'isArchive': false, 'isLabelSearch': false, 'postId': 7672746776551574219}}]);
_WidgetManager._RegisterWidget('_NavbarView', new _WidgetInfo('Navbar1', 'navbar', document.getElementById('Navbar1'), {}, 'displayModeFull'));
_WidgetManager._RegisterWidget('_HeaderView', new _WidgetInfo('Header1', 'header', document.getElementById('Header1'), {}, 'displayModeFull'));
_WidgetManager._RegisterWidget('_BlogView', new _WidgetInfo('Blog1', 'main', document.getElementById('Blog1'), {'cmtInteractionsEnabled': false, 'lightboxEnabled': true, 'lightboxModuleUrl': 'https://www.blogger.com/static/v1/jsbin/3842676126-lbx.js', 'lightboxCssUrl': 'https://www.blogger.com/static/v1/v-css/828616780-lightbox_bundle.css'}, 'displayModeFull'));
_WidgetManager._RegisterWidget('_ProfileView', new _WidgetInfo('Profile1', 'sidebar-right-1', document.getElementById('Profile1'), {}, 'displayModeFull'));
_WidgetManager._RegisterWidget('_PageListView', new _WidgetInfo('PageList1', 'sidebar-right-1', document.getElementById('PageList1'), {'title': 'Quick Links', 'links': [{'isCurrentPage': false, 'href': 'http://blog.dscpl.com.au/p/decorators-and-monkey-patching.html', 'id': '3350721465154129789', 'title': 'Decorators and monkey patching.'}, {'isCurrentPage': false, 'href': 'http://blog.dscpl.com.au/p/using-python-with-docker.html', 'id': '5591286857776935907', 'title': 'Using Python with Docker.'}], 'mobile': false, 'showPlaceholder': true, 'hasCurrentPage': false}, 'displayModeFull'));
_WidgetManager._RegisterWidget('_BlogArchiveView', new _WidgetInfo('BlogArchive1', 'sidebar-right-1', document.getElementById('BlogArchive1'), {'languageDirection': 'ltr', 'loadingMessage': 'Loading\x26hellip;'}, 'displayModeFull'));
_WidgetManager._RegisterWidget('_LabelView', new _WidgetInfo('Label1', 'sidebar-right-1', document.getElementById('Label1'), {}, 'displayModeFull'));
_WidgetManager._RegisterWidget('_AdSenseView', new _WidgetInfo('AdSense1', 'footer-1', document.getElementById('AdSense1'), {}, 'displayModeFull'));
_WidgetManager._RegisterWidget('_AttributionView', new _WidgetInfo('Attribution1', 'footer-3', document.getElementById('Attribution1'), {}, 'displayModeFull'));
</script>
</body>
</html>